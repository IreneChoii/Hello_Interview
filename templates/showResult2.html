<!DOCTYPE html>
<html lang="ko">

<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>ğŸ’— Interview Result ğŸ’—</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <style>
            .chart-container {
                  position: relative;
                  height: 300px; /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ë†’ì´ ê³ ì • */
                  width: 100%;
            }
      </style>
</head>

<body>
      <div class="container mt-4">
            <h4 class="mb-3"> ğŸ’— Interview Result ğŸ’— </h4>
            <hr>
            <div class="row">
                  <div class="col-md-6 mb-4">
                        <div class="card h-100">
                              <div class="card-body">
                                    <h5 class="card-title">â­ï¸ í¸í•¨/ë¶ˆí¸í•¨ ë¹„ìœ¨ â­ï¸</h5>
                                    <div class="chart-container">
                                          <canvas id="pieChart"></canvas>
                                    </div>
                              </div>
                        </div>
                  </div>
                  <div class="col-md-6 mb-4">
                        <div class="card h-100">
                              <div class="card-body">
                                    <h5 class="card-title">ğŸ˜£ ë¶ˆí¸í•¨ ë¹„ìœ¨ ğŸ˜£</h5>
                                    <div class="chart-container">
                                          <canvas id="barChart"></canvas>
                                    </div>
                              </div>
                        </div>
                  </div>
            </div>
            <h2 class="mb-3">ğŸ“Š Motion Analysis ğŸ“Š</h2>
            <div class="card">
                  <div class="card-body">
                        <h5 class="card-title">â­ï¸ í”¼ë“œë°± â­ï¸</h5>
                        <div id="content"></div>
                  </div>
            </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
      <script>
            let content = document.getElementById('content');

            function reset() {
                  // ë¹„ë””ì˜¤ ë¶„ì„ ê²°ê³¼ ê°€ì ¸ì™€ í‘œì‹œ
                  let videoAnalysisResult = sessionStorage.getItem("videoAnalysisResult");
                  content.style.whiteSpace = "pre-wrap";
                  content.innerHTML = videoAnalysisResult;
                  

                  // í¸í•¨/ë¶ˆí¸í•¨ ë¹„ìœ¨ ë°ì´í„° ê°€ì ¸ì˜´
                  let final_comfort_ratio = parseInt(sessionStorage.getItem("final_comfort_ratio"));
                  let final_uncomfort_ratio = parseInt(sessionStorage.getItem("final_uncomfort_ratio"));

                  // ì›í˜• ê·¸ë˜í”„ ìƒì„±
                  var ctx = document.getElementById('pieChart').getContext('2d');
                  var pieChart = new Chart(ctx, {
                        type: 'pie',
                        data: {
                              labels: ['í¸í•¨', 'ë¶ˆí¸í•¨'],
                              datasets: [{
                                    data: [final_comfort_ratio, final_uncomfort_ratio],
                                    backgroundColor: ['#36a2eb', '#ff6384']
                              }]
                        },
                        options: {
                              responsive: true,
                              plugins: {
                                    legend: {
                                          position: 'top',
                                    },
                                    tooltip: {
                                          callbacks: {
                                                label: function (context) {
                                                      let label = context.label || '';
                                                      if (label) {
                                                            label += ': ';
                                                      }
                                                      let value = context.parsed || 0;
                                                      label += value + '%';
                                                      return label;
                                                }
                                          }
                                    }
                              }
                        }
                  });

                  // ë§‰ëŒ€ ê·¸ë˜í”„ìš© ë°ì´í„° ê°€ì ¸ì˜´
                  var barctx = document.getElementById('barChart').getContext('2d');
                  let final_hand_ratio = parseInt(sessionStorage.getItem("final_hand_ratio"));
                  let final_face_ratio = parseInt(sessionStorage.getItem("final_face_ratio"));
                  let final_head_ratio = parseInt(sessionStorage.getItem("final_head_ratio"));
                  let final_arm_ratio = parseInt(sessionStorage.getItem("final_arm_ratio"));
                  let final_shoulder_ratio = parseInt(sessionStorage.getItem("final_shoulder_ratio"));
                  let final_handtouch_ratio = parseInt(sessionStorage.getItem("final_handtouch_ratio"));

                  // ë§‰ëŒ€ ê·¸ë˜í”„ ë°ì´í„° ì„¤ì •
                  var bardata = {
                        labels: ['ì† ì›€ì§ì´ê¸°', 'ì–¼êµ´', 'ë¨¸ë¦¬', 'íŒ”ì§±', 'íŒ” ë§Œì§€ê¸°', 'ì† ëª¨ìœ¼ê¸°'],
                        datasets: [{
                              label: 'ë¶ˆí¸í•œ í–‰ë™ ë¹„ìœ¨',
                              data: [final_hand_ratio, final_face_ratio, final_head_ratio, final_arm_ratio, final_shoulder_ratio, final_handtouch_ratio],
                              backgroundColor: ['#36a2eb', '#ff6384', '#4bc0c0', '#ffcd56', '#a3bac3', '#c5d86d']
                        }]
                  };

                  // ë§‰ëŒ€ ê·¸ë˜í”„ ì˜µì…˜ ì„¤ì •
                  var options = {
                        scales: {
                              y: {
                                    beginAtZero: true,
                                    max: 100
                              }
                        },
                        plugins: {
                              legend: {
                                    display: false
                              }
                        },
                        responsive: true
                  };

                  // ë§‰ëŒ€ ê·¸ë˜í”„ ìƒì„±
                  var barChart = new Chart(barctx, {
                        type: 'bar',
                        data: bardata,
                        options: options
                  });
            }

            // í˜ì´ì§€ ë¡œë“œ ì‹œ reset í•¨ìˆ˜ ì‹¤í–‰
            window.onload = reset;
      </script>
</body>

</html>